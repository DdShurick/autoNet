#!/bin/sh
#DdShurick GPL v2 03.08.2018
[ "$1" ] || exit 0

ST="$(/bin/grep $2 /etc/net/interfaces.lck | cut -f3 -d" ")"

if [ "$ST" ]; then
	[ "$ST" = "down" ] && exit 0
else
	/bin/echo "$@" | tee -a /etc/net/interfaces.lck
	[ "$(/bin/echo $1 | /bin/grep ^e[nt])" ] || exit 0
fi

case $1 in
lo)
	/sbin/ifconfig lo 127.0.0.1 up
	/sbin/route add -net 127.0.0.0 netmask 255.0.0.0 lo
	exit 0
;;
e[nt]*)
	/usr/sbin/lan.sh $1 &
;;
wl*)
	/usr/sbin/wlan.sh $1 &
;;
usb?|ww*)
	sleep 3
	/usr/sbin/lan.sh $1 &
;;
esac

until [ -s /tmp/dsp ]; do /bin/sleep 1; done;
[ "$(/bin/pidof netTun)" ] && exit 0
export DISPLAY="$(cat /tmp/dsp)" 
export $(/bin/grep LANG= /etc/profile)
/usr/bin/netTun &

